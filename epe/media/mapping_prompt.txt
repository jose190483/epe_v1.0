I want a simple function which helps me to extract data from consolidated excel placed in C:\Users\waltjos01\PycharmProjects\epe_v2.0\epe\media\consolidated_Excel_v2.0.xlsx into respective tables in database. if values are sepearated by "|" then cosntider each value as separate record.

1. From column 'System' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'system_name' in postgresql table 'system_Info'. For each record in postgresql table 'system_Info', system_name_short should be combination of first letter of 'system_name'

2. From column 'Equipment' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'equipment_name' in postgresql table 'equipmentInfo'. For each record in postgresql table 'equipmentInfo', equipment_name_short should be combination of first letter of 'equipment_name'. Then in column 'equipment_system_name' map the primary value of system_Info if values from excel corresponding value in "system " match with system_name. If one equipment_name match with more than one system then add new record for each unique system.

3. From column 'Data Type' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'dt_name' in postgresql table 'datatype_Info'.
4. From column 'Discipline Attribute Ownership' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'owner_name' in postgresql table 'owner_info'.
5. From column 'Digital Data Source' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'ds_name' in postgresql table 'digital_source_info'.
6. From column 'Unit Type' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'ut_name' in postgresql table 'unit_type_info'.
7. From column 'UOM' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'uom_symbol' in postgresql table 'uom_info'. For each record in postgresql table 'uom_info', uom_unit_type' map the primary value of unit_type_info if values from excel corresponding value in "Unit Type" match with ut_name.

8. From column 'DICTIONARY Parameter' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'pd_name' in postgresql table 'prameter_definition_info'. For each record in postgresql table 'prameter_definition_info', 'pd_unit_type' map the primary value of unit_type_info if values from excel corresponding value in "Unit Type" match with ut_name. Then in table 'prameter_definition_info' assign 'pd_library' = 1, 'pd_status' = 1, 'pd_id' = PD_1000000+ID, 'pd_description' = cleaned values from excel column "PARAMETER Description" to be add/updated in table "prameter_definition_info", 'pd_updated_at' = Curren date and time, 'pd_updated_by' = 1, 'pd_datatype' = map the primary value of datatype_Info if values from excel corresponding value in "Data Type" match with dt_name.

9. From column 'List Of Discrete Values' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'pdl_lov' in postgresql table 'parameter_definition_lov_info'.if values are sepearated by "|" then cosntider each value as separate record. Then 'pdl_parameter_definition'= map the primary value of prameter_definition_info if values from excel corresponding value in "DICTIONARY Parameter" match with pd_name

10. From column 'Parameter instance' extract cleaned (unique, trim spaces from start & end, remove double spaces, all lower) into column 'p_name' in postgresql table 'prameter_info'. Then in table  prameter_info, 'p_id' = P_1000000+ID, 'p_name_as_is'= map the primary value of prameter_definition_info if values from excel corresponding value in "DICTIONARY Parameter" match with pd_name, p_name_as_is=cleaned values from excel column "DOCT AS IS PARAMETER NOMENCLATURE", p_uom = map the primary value of uom_info if values from excel corresponding value in "UOM" match with uom_symbol, p_definition=map the primary value of prameter_definition_info if values from excel corresponding value in "DICTIONARY Parameter" match with pd_name, p_system=map the primary value of system_Info if values from excel corresponding value in "System" match with system_name, p_system_short=map the value of system_name_short from table 'system_Info' for corresponding system_name, p_unit_type=map the primary value of unit_type_info if values from excel corresponding value in "Unit Type" match with ut_name,p_equipment_name=map the primary value of equipmentInfo if values from excel corresponding value in "Equipment" match with equipment_name,p_equipment_short=map the value of equipment_name_short from equipmentInfo table for corresponding equipment_name, p_status=Assign value as 1,p_parameter_name_combo=cleaned values from excel column "Parameter instance" to be add/updated in table "prameter_info" column name "p_parameter_name_combo", p_updated_at=Curren date and time,p_updated_by=Assign value as 1,p_parameter_prefix,cleaned values from excel column "Parameter Definition Sub Class"

11. In table 'prameter_info_p_digital_source', 'parameter_info_id' = map all id value of prameter_info table which has non-null vlaue in column "Digital Data Source" and 'digital_source_info_id' = map the primary id of digital_source_info if values from excel corresponding value in "Digital Data Source" match with ds_name for each parameter_info_id. If digital source are separated by pip separator then add new record.

12. In table 'prameter_info_p_owner', 'parameter_info_id' = map all id value of prameter_info table which has non-null vlaue in column "Discipline Attribute Ownership" and 'owner_info_id' =map the primary value of owner_info if values from excel corresponding value in "Discipline Attribute Ownership" match with owner_namefor each parameter_info_id. If owner are separated by pipe separation then add new record. If Discipline Attribute Ownership are separated by pip separator then add new record.