
{% block content %}
{% load widget_tweaks %}
<div class="container_fluid shadow-box-table">
    <div class="d-flex justify-content-center">
        <h5 class="shadow-sm rounded text-center bg-info text-white p-2">Parameter Definition List of Values</h5>
    </div>
    <div class="d-flex gap-2 justify-content-start m-2">
        <!--        <a href="{% url 'home_page' %}" class="btn btn-primary btn-sm">-->
        <!--            <i class="fas fa-arrow-left"></i> Back-->
        <!--        </a>-->
        <!--        <a href="{% url 'parameter_definition_lov_insert' %}" class="btn btn-success btn-sm">-->
        <!--            <i class="fas fa-plus"></i> Add-->
        <!--        </a>-->
        <!-- add LOV-->
        <button type="button" class="btn btn-primary shadow-none"  id="add_lov_btn" data-bs-toggle="modal" data-bs-target="#add_lov">
            Add
        </button>
        <!-- Modal -->
        <div class="modal fade" id="add_lov" tabindex="-1" aria-labelledby="add_lovLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="add_lovLabel">List Of Values</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form method="POST" action="{% url 'parameter_definition_lov_insert' %}">
                            {% csrf_token %}
                            <div class="input-group input-group-sm mb-2">
                                <span class="input-group-text">Parameter Definition</span>
                                {% render_field pd_lov_form.pdl_parameter_definition class="form-select bg-secondary text-white" id="pdl_parameter_definition" %}
                            </div>
                            <div class="input-group input-group-sm">
                                <span class="input-group-text">List of Values</span>
                                {% render_field pd_lov_form.pdl_lov class="form-control" id="pdl_lov"%}
                            </div>
                            <br>
                            <div class="d-flex col justify-content-center ">
                                {% for message in messages %}
                                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %} py-1 mb-2">
                                    {{ message }}
                                </div>
                                {% endfor %}
                            </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary">Save changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <table id="param_def_lov_list" class="table table-striped table-bordered border-secondary-subtle table-responsive table-sm nowrap mt-2">
        <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Parameter Definition</th>
            <th>List of Values</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
        </thead>
        <tbody>
        {% for param_def_lov in parameter_definition_lov_list %}
        <tr>
            <td>{{ param_def_lov.id }}</td>
            <td>{{ param_def_lov.pdl_parameter_definition }}</td>
            <td>{{ param_def_lov.pdl_lov }}</td>
            <td class="text-center">
                <a class="btn btn-sm btn-primary" href="{% url 'parameter_definition_lov_update' param_def_lov.id %}">
                    <i class="far fa-edit"></i>
                </a>
<!--                &lt;!&ndash; editLOV&ndash;&gt;-->
<!--                <button type="button" class="btn btn-primary shadow-none" onclick="load_lov({{param_def_lov.id}})" id="edit_lov_btn" docs-bs-toggle="modal" docs-bs-target="#edit_lov">-->
<!--                    Edit-->
<!--                </button>-->
                <!-- Modal -->
                <div class="modal fade" id="edit_lov" tabindex="-1" aria-labelledby="edit_lovLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="edit_lovLabel">List Of Values</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form method="POST" action="{% url 'parameter_definition_lov_update' param_def_lov.id%}">
                                    {% csrf_token %}
                                    <div class="input-group input-group-sm mb-2">
                                        <span class="input-group-text">ID</span>
                                        {% render_field pd_lov_form.pk class="form-control" id="lov_id_edit" %}
                                    </div>
                                    <div class="input-group input-group-sm mb-2">
                                        <span class="input-group-text">Parameter Definition</span>
                                        {% render_field pd_lov_form.pdl_parameter_definition class="form-select bg-secondary text-white" id="pdl_parameter_definition_edit" %}
                                    </div>
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">List of Values</span>
                                        {% render_field pd_lov_form.pdl_lov class="form-control" id="pdl_lov_edit"%}
                                    </div>
                                    <br>
                                    <div class="d-flex col justify-content-center ">
                                        {% for message in messages %}
                                        <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %} py-1 mb-2">
                                            {{ message }}
                                        </div>
                                        {% endfor %}
                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button type="submit" class="btn btn-primary">Save changes</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
            <td class="text-center">
                <form action="{% url 'parameter_definition_lov_delete' param_def_lov.id %}" method="post" onsubmit="return confirm('Are you sure?');">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-danger">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </form>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock content %}

{% block scripts %}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        new DataTable('#param_def_lov_list', {
            responsive: true,
            order: [[0, 'desc']],
            dom: '<"row align-items-center mb-3"' +
                '<"col-md-4"l>' +        // Length dropdown (entries per page)
                '<"col-md-4 text-center"B>' + // Export buttons
                '<"col-md-4 text-end"f>' +    // Search box
                '>rt' +
                '<"row mt-3"' +
                '<"col-md-6"i>' +        // Table info
                '<"col-md-6 text-end"p>' +  // Pagination
                '>',
            buttons: ['copy', 'excel', 'pdf']
        });
    });
</script>
<script>
    function load_lov(id)
    {
      var lov_id = id;
      $.ajax({
        url: "{% url 'load_lov' %}",
        data: {
          'lov_id': lov_id
        },
        success: function (data) {
            var abc=document.getElementById("lov_id_edit").value
            alert(abc)
            var lov_id=JSON.parse(data)["lov_id"];
            var pdl_parameter_definition=JSON.parse(data)["pdl_parameter_definition"];
            var pdl_lov=JSON.parse(data)["pdl_lov"];
            alert(lov_id)
            alert(pdl_parameter_definition)
            alert(pdl_lov)
            document.getElementById("lov_id_edit").value =lov_id;
            document.getElementById("pdl_parameter_definition_edit").value =pdl_parameter_definition;
            document.getElementById("pdl_lov_edit").value =pdl_lov;
        }
      });
    };
</script>

{% endblock scripts %}
